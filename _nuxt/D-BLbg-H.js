import{u as Y}from"./Dnyz8t2s.js";import{_ as I,o as l,c as u,a as V,C as p,p as m,a0 as y,q as v,F as g,n as S,m as $,s as j,a1 as J,d as N,t as C,x as G,y as F,N as U,i as k,j as q,Z as P,O as E,a2 as Z,k as M,L as R,a3 as D}from"./CFhrp1Et.js";import{d as L}from"./DVfcsc2F.js";const T={wrapper:"",inner:"",label:{wrapper:"flex content-center items-center justify-between",base:"block font-medium text-gray-700 dark:text-gray-200",required:"after:content-['*'] after:ms-0.5 after:text-red-500 dark:after:text-red-400"},size:{"2xs":"text-xs",xs:"text-xs",sm:"text-sm",md:"text-sm",lg:"text-sm",xl:"text-base"},container:"mt-1 relative",description:"text-gray-500 dark:text-gray-400",hint:"text-gray-500 dark:text-gray-400",help:"mt-2 text-gray-500 dark:text-gray-400",error:"mt-2 text-red-500 dark:text-red-400",default:{size:"sm"}},B=G(F.ui.strategy,F.ui.formGroup,T),H=N({inheritAttrs:!1,props:{name:{type:String,default:null},size:{type:String,default:null,validator(e){return Object.keys(B.size).includes(e)}},label:{type:String,default:null},description:{type:String,default:null},required:{type:Boolean,default:!1},help:{type:String,default:null},error:{type:[String,Boolean],default:null},hint:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},eagerValidation:{type:Boolean,default:!1}},setup(e){const{ui:r,attrs:t}=Y("formGroup",C(e,"ui"),B,C(e,"class")),o=U("form-errors",null),s=k(()=>{var b,c;return e.error&&typeof e.error=="string"||typeof e.error=="boolean"?e.error:(c=(b=o==null?void 0:o.value)==null?void 0:b.find(w=>w.path===e.name))==null?void 0:c.message}),n=k(()=>r.value.size[e.size??B.default.size]),f=q(P());return E("form-group",{error:s,inputId:f,name:k(()=>e.name),size:k(()=>e.size),eagerValidation:k(()=>e.eagerValidation)}),{ui:r,attrs:t,inputId:f,size:n,error:s}}}),K=["for"];function Q(e,r,t,o,s,n){return l(),u("div",v({class:e.ui.wrapper},e.attrs),[V("div",{class:p(e.ui.inner)},[e.label||e.$slots.label?(l(),u("div",{key:0,class:p([e.ui.label.wrapper,e.size])},[V("label",{for:e.inputId,class:p([e.ui.label.base,e.required?e.ui.label.required:""])},[e.$slots.label?m(e.$slots,"label",y(v({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(l(),u(g,{key:1},[S($(e.label),1)],64))],10,K),e.hint||e.$slots.hint?(l(),u("span",{key:0,class:p([e.ui.hint])},[e.$slots.hint?m(e.$slots,"hint",y(v({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(l(),u(g,{key:1},[S($(e.hint),1)],64))],2)):j("",!0)],2)):j("",!0),e.description||e.$slots.description?(l(),u("p",{key:1,class:p([e.ui.description,e.size])},[e.$slots.description?m(e.$slots,"description",y(v({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(l(),u(g,{key:1},[S($(e.description),1)],64))],2)):j("",!0)],2),V("div",{class:p([e.label?e.ui.container:""])},[m(e.$slots,"default",y(J({error:e.error}))),typeof e.error=="string"&&e.error?(l(),u("p",{key:0,class:p([e.ui.error,e.size])},[e.$slots.error?m(e.$slots,"error",y(v({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(l(),u(g,{key:1},[S($(e.error),1)],64))],2)):e.help||e.$slots.help?(l(),u("p",{key:1,class:p([e.ui.help,e.size])},[e.$slots.help?m(e.$slots,"help",y(v({key:0},{error:e.error,label:e.label,name:e.name,hint:e.hint,description:e.description,help:e.help}))):(l(),u(g,{key:1},[S($(e.help),1)],64))],2)):j("",!0)],2)],16)}const ye=I(H,[["render",Q]]);class O extends Error{constructor(r){super(r),this.message=r,Object.setPrototypeOf(this,O.prototype)}}const W=N({props:{schema:{type:[Object,Function],default:void 0},state:{type:Object,required:!0},validate:{type:Function,default:()=>[]},validateOn:{type:Array,default:()=>["blur","input","change","submit"]}},emits:["submit","error"],setup(e,{expose:r,emit:t}){const o=P(),s=L(`form-${o}`);M(()=>{s.on(async a=>{var i;a.type!=="submit"&&((i=e.validateOn)!=null&&i.includes(a.type))&&await c(a.path,{silent:!0})})}),R(()=>{s.reset()});const n=q([]);E("form-errors",n),E("form-events",s);const f=q({});E("form-inputs",f);async function b(){let a=await e.validate(e.state);if(e.schema){const{errors:i,result:d}=await ue(e.state,e.schema);i?a=a.concat(i):Object.assign(e.state,d)}return a}async function c(a,i={silent:!1}){let d=a;if(a&&!Array.isArray(a)&&(d=[a]),d){const z=n.value.filter(h=>!d.includes(h.path)),A=(await b()).filter(h=>d.includes(h.path));n.value=z.concat(A)}else n.value=await b();if(n.value.length>0){if(i.silent)return!1;throw new O(`Form validation failed: ${JSON.stringify(n.value,null,2)}`)}return e.state}async function w(a){var d;const i=a;try{(d=e.validateOn)!=null&&d.includes("submit")&&await c(),i.data=e.state,t("submit",i)}catch(z){if(!(z instanceof O))throw z;const A={...i,errors:n.value.map(h=>({...h,id:f.value[h.path]}))};t("error",A)}}return r({validate:c,errors:n,setErrors(a,i){i?n.value=n.value.filter(d=>d.path!==i).concat(a):n.value=a},async submit(){await w(new Event("submit"))},getErrors(a){return a?n.value.filter(i=>i.path===a):n.value},clear(a){a?n.value=n.value.filter(i=>i.path!==a):n.value=[]}}),{onSubmit:w,errors:D(n)}}});function X(e){return e.validate&&e.__isYupSchema__}function x(e){return e.inner!==void 0}function _(e){return"schema"in e&&typeof e.coercer=="function"&&typeof e.validator=="function"&&typeof e.refiner=="function"}function ee(e){return e.validateAsync!==void 0&&e.id!==void 0}function re(e){return e.isJoi===!0}function te(e){return"_parse"in e||"_run"in e||typeof e=="function"&&"schema"in e}function ne(e){return e.parse!==void 0}async function ae(e,r){const t=await("_parse"in r?r._parse(e):"_run"in r?r._run({typed:!1,value:e},{}):r(e));return!t.issues||t.issues.length===0?{errors:null,result:"output"in t?t.output:"value"in t?t.value:null}:{errors:t.issues.map(s=>{var n;return{path:((n=s.path)==null?void 0:n.map(f=>f.key).join("."))||"",message:s.message}}),result:null}}async function se(e,r){try{return await r.validateAsync(e,{abortEarly:!1}),{errors:null,result:e}}catch(t){if(re(t))return{errors:t.details.map(s=>({path:s.path.join("."),message:s.message})),result:null};throw t}}async function ie(e,r){const t=await r.safeParseAsync(e);return t.success===!1?{errors:t.error.issues.map(s=>({path:s.path.join("."),message:s.message})),result:null}:{result:t.data,errors:null}}async function oe(e,r){const[t,o]=r.validate(e);return t?{errors:t.failures().map(n=>({message:n.message,path:n.path.join(".")})),result:null}:{errors:null,result:o}}async function le(e,r){try{return{errors:null,result:r.validateSync(e,{abortEarly:!1})}}catch(t){if(x(t))return{errors:t.inner.map(s=>({path:s.path??"",message:s.message})),result:null};throw t}}function ue(e,r){if(ne(r))return ie(e,r);if(ee(r))return se(e,r);if(te(r))return ae(e,r);if(X(r))return le(e,r);if(_(r))return oe(e,r);throw new Error("Form validation failed: Unsupported form schema")}function de(e,r,t,o,s,n){return l(),u("form",{onSubmit:r[0]||(r[0]=Z((...f)=>e.onSubmit&&e.onSubmit(...f),["prevent"]))},[m(e.$slots,"default",y(J({errors:e.errors})))],32)}const ce=I(W,[["render",de]]);export{ye as _,ce as a};
